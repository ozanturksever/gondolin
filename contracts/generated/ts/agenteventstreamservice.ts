// Code generated by dink codegen. DO NOT EDIT.

import type { ServiceCaller, Subscription } from '@fatagnus/dink-sdk';
import type { StreamEventsRequest, StreamEventsResponse } from './types.js';

// ============================================================================
// AI Context Types
// ============================================================================

/**
 * Service AI context providing AI-specific guidance.
 */
export interface ServiceAIContext {
  overview?: string;
  capabilities?: string[];
  limitations?: string[];
}

/**
 * Method AI context providing AI-specific guidance.
 */
export interface MethodAIContext {
  whenToUse?: string;
  whyToUse?: string;
  howToUse?: string;
  preconditions?: string[];
  sideEffects?: string[];
  relatedMethods?: string[];
  scenarios?: string[];
}

/**
 * Method descriptor providing complete metadata about a service method.
 */
export interface MethodDescriptor {
  name: string;
  description?: string;
  inputSchema?: Record<string, unknown>;
  outputSchema?: Record<string, unknown>;
  aiContext?: MethodAIContext;
}

/**
 * Service descriptor providing complete metadata about a service.
 */
export interface ServiceDescriptor {
  name: string;
  version: string;
  description?: string;
  aiContext?: ServiceAIContext;
  methods: MethodDescriptor[];
}

// ============================================================================
// AgentEventStreamService Client Class
// ============================================================================

class AgentEventStreamServiceClientImpl {
  private edgeId: string;
  private caller: ServiceCaller;

  constructor(edgeId: string, caller: ServiceCaller) {
    this.edgeId = edgeId;
    this.caller = caller;
  }

  getEdgeId(): string {
    return this.edgeId;
  }


  async StreamEvents(req: StreamEventsRequest, handler: (resp: StreamEventsResponse) => void): Promise<Subscription> {
    return this.caller.subscribe<StreamEventsRequest, StreamEventsResponse>(
      this.edgeId,
      'AgentEventStreamService',
      'StreamEvents',
      req,
      handler
    );
  }


}

// ============================================================================
// AgentEventStreamService Service Descriptor (Embedded AI Metadata)
// ============================================================================

const descriptor: ServiceDescriptor = {
  name: "AgentEventStreamService",
  version: "1.0.0",
  description: "AgentEventStreamService provides real-time event streaming from agent sessions. Bridges sandbox-agent SSE to Dink NATS streaming.",
  methods: [
    {
      name: "CreateSession",
      description: "CreateSession starts a new AI agent session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"agent":{"type":"object"},"agentMode":{"type":"string"},"env":{"additionalProperties":{"type":"string"},"type":"object"},"model":{"type":"string"},"permissionMode":{"type":"object"},"sessionId":{"type":"string"},"workingDirectory":{"type":"string"}},"required":["sessionId","agent","agentMode","permissionMode","model","workingDirectory","env"],"title":"CreateSessionRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"createdAt":{"format":"date-time","type":"string"},"sessionId":{"type":"string"},"status":{"type":"object"}},"required":["sessionId","status","createdAt"],"title":"CreateSessionResponse","type":"object"},
    },
    {
      name: "SendMessage",
      description: "SendMessage sends a user message to an active session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"content":{"type":"string"},"model":{"type":"string"},"options":{"additionalProperties":true,"type":"object"},"sessionId":{"type":"string"},"workingDirectory":{"type":"string"}},"required":["sessionId","content","workingDirectory","model","options"],"title":"SendMessageRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"accepted":{"type":"boolean"}},"required":["accepted"],"title":"SendMessageResponse","type":"object"},
    },
    {
      name: "TerminateSession",
      description: "TerminateSession stops an active agent session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"sessionId":{"type":"string"}},"required":["sessionId"],"title":"TerminateSessionRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"terminated":{"type":"boolean"}},"required":["terminated"],"title":"TerminateSessionResponse","type":"object"},
    },
    {
      name: "ListSessions",
      description: "ListSessions returns all sessions on this VM.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{},"title":"ListSessionsRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"sessions":{"items":{"properties":{"agent":{"type":"object"},"createdAt":{"format":"date-time","type":"string"},"eventCount":{"description":"32-bit signed integer","type":"integer"},"sessionId":{"type":"string"},"status":{"type":"object"}},"required":["sessionId","agent","status","createdAt","eventCount"],"type":"object"},"type":"array"}},"required":["sessions"],"title":"ListSessionsResponse","type":"object"},
    },
    {
      name: "GetEvents",
      description: "GetEvents retrieves past events for a session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"limit":{"description":"32-bit signed integer","type":"integer"},"offset":{"description":"32-bit signed integer","type":"integer"},"sessionId":{"type":"string"}},"required":["sessionId","offset","limit"],"title":"GetEventsRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"events":{"items":{"properties":{"agent":{"type":"string"},"data":{"additionalProperties":true,"type":"object"},"id":{"description":"32-bit signed integer","type":"integer"},"sessionId":{"type":"string"},"timestamp":{"format":"date-time","type":"string"},"type":{"type":"object"}},"required":["id","timestamp","sessionId","agent","type","data"],"type":"object"},"type":"array"},"total":{"description":"32-bit signed integer","type":"integer"}},"required":["events","total"],"title":"GetEventsResponse","type":"object"},
    },
    {
      name: "ReplyQuestion",
      description: "ReplyQuestion answers a human-in-the-loop question from the agent.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"answers":{"items":{"type":"string"},"type":"array"},"questionId":{"type":"string"},"sessionId":{"type":"string"}},"required":["sessionId","questionId","answers"],"title":"ReplyQuestionRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"accepted":{"type":"boolean"}},"required":["accepted"],"title":"ReplyQuestionResponse","type":"object"},
    },
    {
      name: "ReplyPermission",
      description: "ReplyPermission responds to an agent permission request.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"permissionId":{"type":"string"},"reply":{"type":"string"},"sessionId":{"type":"string"}},"required":["sessionId","permissionId","reply"],"title":"ReplyPermissionRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"accepted":{"type":"boolean"}},"required":["accepted"],"title":"ReplyPermissionResponse","type":"object"},
    },
    {
      name: "StreamEvents",
      description: "StreamEvents subscribes to real-time events from an agent session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"fromId":{"description":"32-bit signed integer","type":"integer"},"sessionId":{"type":"string"}},"required":["sessionId","fromId"],"title":"StreamEventsRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"event":{"properties":{"agent":{"type":"string"},"data":{"additionalProperties":true,"type":"object"},"id":{"description":"32-bit signed integer","type":"integer"},"sessionId":{"type":"string"},"timestamp":{"format":"date-time","type":"string"},"type":{"type":"object"}},"required":["id","timestamp","sessionId","agent","type","data"],"type":"object"}},"required":["event"],"title":"StreamEventsResponse","type":"object"},
    },
    {
      name: "Open",
      description: "Open creates a new terminal session with the given dimensions.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"cols":{"description":"32-bit signed integer","type":"integer"},"cwd":{"type":"string"},"env":{"additionalProperties":{"type":"string"},"type":"object"},"rows":{"description":"32-bit signed integer","type":"integer"},"shell":{"type":"string"}},"required":["cols","rows","shell","cwd","env"],"title":"OpenRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"streamId":{"type":"string"}},"required":["streamId"],"title":"OpenResponse","type":"object"},
    },
    {
      name: "Input",
      description: "Input sends keystrokes to a terminal session.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"data":{"format":"byte","type":"string"},"streamId":{"type":"string"}},"required":["streamId","data"],"title":"InputRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{},"title":"InputResponse","type":"object"},
    },
    {
      name: "Resize",
      description: "Resize changes the terminal dimensions.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"cols":{"description":"32-bit signed integer","type":"integer"},"rows":{"description":"32-bit signed integer","type":"integer"},"streamId":{"type":"string"}},"required":["streamId","cols","rows"],"title":"ResizeRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{},"title":"ResizeResponse","type":"object"},
    },
    {
      name: "StreamOutput",
      description: "StreamOutput subscribes to real-time terminal output.",
      inputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"streamId":{"type":"string"}},"required":["streamId"],"title":"StreamOutputRequest","type":"object"},
      outputSchema: {"$schema":"https://json-schema.org/draft/2020-12/schema","properties":{"data":{"format":"byte","type":"string"},"streamId":{"type":"string"},"timestamp":{"format":"date-time","type":"string"}},"required":["streamId","data","timestamp"],"title":"StreamOutputResponse","type":"object"},
    },
  ],
};

const definition = {
  name: 'AgentEventStreamService',
  version: '1.0.0',
  methods: [
    'StreamEvents',
  ],
};

// ============================================================================
// Helper Functions
// ============================================================================

function formatAsLLMTxt(sd: ServiceDescriptor): string {
  const lines: string[] = [];

  lines.push(`# ${sd.name} LLM Reference`);
  lines.push('');

  if (sd.description) {
    lines.push(`> ${sd.description}`);
    lines.push('');
  }

  if (sd.aiContext) {
    if (sd.aiContext.overview) {
      lines.push('## When to Use This Service');
      lines.push('');
      lines.push(sd.aiContext.overview);
      lines.push('');
    }

    if (sd.aiContext.capabilities && sd.aiContext.capabilities.length > 0) {
      lines.push('## Capabilities');
      lines.push('');
      for (const cap of sd.aiContext.capabilities) {
        lines.push(`- ${cap}`);
      }
      lines.push('');
    }

    if (sd.aiContext.limitations && sd.aiContext.limitations.length > 0) {
      lines.push('## Limitations');
      lines.push('');
      for (const lim of sd.aiContext.limitations) {
        lines.push(`- ${lim}`);
      }
      lines.push('');
    }
  }

  if (sd.methods.length > 0) {
    lines.push('## Methods');
    lines.push('');

    for (const method of sd.methods) {
      lines.push(`### ${method.name}`);
      lines.push('');

      if (method.description) {
        lines.push(method.description);
        lines.push('');
      }

      if (method.aiContext) {
        if (method.aiContext.whenToUse) {
          lines.push(`**When to use:** ${method.aiContext.whenToUse}`);
          lines.push('');
        }
        if (method.aiContext.whyToUse) {
          lines.push(`**Why:** ${method.aiContext.whyToUse}`);
          lines.push('');
        }
        if (method.aiContext.howToUse) {
          lines.push(`**How:** ${method.aiContext.howToUse}`);
          lines.push('');
        }
      }

      if (method.inputSchema) {
        lines.push('#### Request Schema');
        lines.push('');
        lines.push('```json');
        lines.push(JSON.stringify(method.inputSchema, null, 2));
        lines.push('```');
        lines.push('');
      }

      if (method.outputSchema) {
        lines.push('#### Response Schema');
        lines.push('');
        lines.push('```json');
        lines.push(JSON.stringify(method.outputSchema, null, 2));
        lines.push('```');
        lines.push('');
      }
    }
  }

  return lines.join('\n');
}

function getMethodAIImpl(methodName: string): MethodAIContext | undefined {
  const method = descriptor.methods.find(m => m.name === methodName);
  return method?.aiContext;
}

function getLLMContextImpl(): string {
  return formatAsLLMTxt(descriptor);
}

// ============================================================================
// AgentEventStreamService Companion Object (Primary Export)
// ============================================================================

/**
 * AgentEventStreamService companion object with embedded AI metadata.
 * 
 * Usage:
 *   import { AgentEventStreamService } from './generated';
 *   
 *   // Create client
 *   const client = new AgentEventStreamService.Client(edgeId, caller);
 *   
 *   // Access embedded AI metadata (no network call)
 *   const serviceAI = AgentEventStreamService.descriptor.aiContext;
 *   const methodAI = AgentEventStreamService.getMethodAI('SomeMethod');
 *   const llmTxt = AgentEventStreamService.getLLMContext();
 */
export const AgentEventStreamService = {
  /** Client class for making RPC calls */
  Client: AgentEventStreamServiceClientImpl,
  /** Full service descriptor with embedded AI context */
  descriptor,
  /** Service definition metadata */
  Definition: definition,
  /** Get AI context for a specific method */
  getMethodAI: getMethodAIImpl,
  /** Get LLM-friendly documentation (llm.txt format) */
  getLLMContext: getLLMContextImpl,
} as const;

// ============================================================================
// Backward-Compatible Exports
// ============================================================================

/** @deprecated Use AgentEventStreamService.Client instead */
export const AgentEventStreamServiceClient = AgentEventStreamServiceClientImpl;

/** @deprecated Use AgentEventStreamService.descriptor instead */
export const AgentEventStreamServiceDescriptor = descriptor;

/** @deprecated Use AgentEventStreamService.Definition instead */
export const AgentEventStreamServiceDefinition = definition;

/** @deprecated Use AgentEventStreamService.getLLMContext() instead */
export function getAgentEventStreamServiceLLMContext(): string {
  return getLLMContextImpl();
}
